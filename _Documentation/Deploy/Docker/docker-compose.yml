version: '3.8'

services:
  
  SqlServer:
    container_name: "SqlServer"
    environment:
      - "ACCEPT_EULA=Y"
      - "MSSQL_PID=Developer"
      - "SA_PASSWORD=tg4mYT%3M&r~QwHEOp9%"
    hostname: "SqlServer"
    image: "mcr.microsoft.com/mssql/server"
    ports:
      - "1433:1433"
    restart: "always"
    volumes:
      - "SqlServer_Data:/var/opt/mssql"

  MongoDB:
    container_name: "MongoDB"
    environment:
      - "MONGO_INITDB_ROOT_USERNAME=root"
      - "MONGO_INITDB_ROOT_PASSWORD=tg4mYT%3M&r~QwHEOp9%"
    hostname: "MongoDB"
    image: "mongo"
    ports:
      - "27017:27017"
    restart: "always"
    volumes:
      - "MongoDB_Config:/data/configdb"
      - "MongoDB_Data:/data/db"

  RabbitMQ:
    container_name: "RabbitMQ"
    environment:
      - "RABBITMQ_DEFAULT_USER=root"
      - "RABBITMQ_DEFAULT_PASS=tg4mYT%3M&r~QwHEOp9%"
    hostname: "RabbitMQ"
    image: "rabbitmq:management"
    ports:
      - "4369:4369"
      - "5671:5671"
      - "5672:5672"
      - "15671:15671"
      - "15672:15672"
      - "15691:15691"
      - "15692:15692"
      - "25672:25672"
    restart: "always"
    volumes:
      - "RabbitMQ_Data:/var/lib/rabbitmq"

  Redis:
    container_name: "Redis"
    hostname: "Redis"
    image: "redis"
    ports:
      - "6379:6379"
    restart: "always"
    volumes:
      - "Redis_Data:/data"

  Elastic:
    container_name: "Elastic"
    command:
      - /bin/bash
      - -c
      - |
        cd /usr/share/elasticsearch/config;

        if [ ! -f "elasticsearch.yml" ]; then touch elasticsearch.yml; fi;
        if [ ! -f "logstash.yml" ];      then touch logstash.yml;      fi;
        if [ ! -f "pipelines.yml" ];     then touch pipelines.yml;     fi;
        if [ ! -f "kibana.yml" ];        then touch kibana.yml;        fi;
        
        if [ -f "elasticsearch.yml" ]; then
          echo -n ""                                                                                           > elasticsearch.yml;
          echo -e "# ======================== Elasticsearch Configuration ========================="          >> elasticsearch.yml;
          echo -e "#"                                                                                         >> elasticsearch.yml;
          echo -e "# NOTE: Elasticsearch comes with reasonable defaults for most settings."                   >> elasticsearch.yml;
          echo -e "#       Before you set out to tweak and tune the configuration, make sure you"             >> elasticsearch.yml;
          echo -e "#       understand what are you trying to accomplish and the consequences."                >> elasticsearch.yml;
          echo -e "#"                                                                                         >> elasticsearch.yml;
          echo -e "# The primary way of configuring a node is via this file. This template lists"             >> elasticsearch.yml;
          echo -e "# the most important settings you may want to configure for a production cluster."         >> elasticsearch.yml;
          echo -e "#"                                                                                         >> elasticsearch.yml;
          echo -e "# Please consult the documentation for further information on configuration options:"      >> elasticsearch.yml;
          echo -e "# https://www.elastic.co/guide/en/elasticsearch/reference/index.html"                      >> elasticsearch.yml;
          echo -e "#"                                                                                         >> elasticsearch.yml;
          echo -e "# ---------------------------------- Cluster -----------------------------------"          >> elasticsearch.yml;
          echo -e "#"                                                                                         >> elasticsearch.yml;
          echo -e "# Use a descriptive name for your cluster:"                                                >> elasticsearch.yml;
          echo -e "#"                                                                                         >> elasticsearch.yml;
          echo -e "cluster.name: docker-cluster"                                                              >> elasticsearch.yml;
          echo -e "#"                                                                                         >> elasticsearch.yml;
          echo -e "# ------------------------------------ Node ------------------------------------"          >> elasticsearch.yml;
          echo -e "#"                                                                                         >> elasticsearch.yml;
          echo -e "# Use a descriptive name for the node:"                                                    >> elasticsearch.yml;
          echo -e "#"                                                                                         >> elasticsearch.yml;
          echo -e "#node.name: node-1"                                                                        >> elasticsearch.yml;
          echo -e "#"                                                                                         >> elasticsearch.yml;
          echo -e "# Add custom attributes to the node:"                                                      >> elasticsearch.yml;
          echo -e "#"                                                                                         >> elasticsearch.yml;
          echo -e "#node.attr.rack: r1"                                                                       >> elasticsearch.yml;
          echo -e "#"                                                                                         >> elasticsearch.yml;
          echo -e "# ----------------------------------- Paths ------------------------------------"          >> elasticsearch.yml;
          echo -e "#"                                                                                         >> elasticsearch.yml;
          echo -e "# Path to directory where to store the data (separate multiple locations by comma):"       >> elasticsearch.yml;
          echo -e "#"                                                                                         >> elasticsearch.yml;
          echo -e "#path.data: /path/to/data"                                                                 >> elasticsearch.yml;
          echo -e "#"                                                                                         >> elasticsearch.yml;
          echo -e "# Path to log files:"                                                                      >> elasticsearch.yml;
          echo -e "#"                                                                                         >> elasticsearch.yml;
          echo -e "#path.logs: /path/to/logs"                                                                 >> elasticsearch.yml;
          echo -e "#"                                                                                         >> elasticsearch.yml;
          echo -e "# ----------------------------------- Memory -----------------------------------"          >> elasticsearch.yml;
          echo -e "#"                                                                                         >> elasticsearch.yml;
          echo -e "# Lock the memory on startup:"                                                             >> elasticsearch.yml;
          echo -e "#"                                                                                         >> elasticsearch.yml;
          echo -e "#bootstrap.memory_lock: true"                                                              >> elasticsearch.yml;
          echo -e "#"                                                                                         >> elasticsearch.yml;
          echo -e "# Make sure that the heap size is set to about half the memory available"                  >> elasticsearch.yml;
          echo -e "# on the system and that the owner of the process is allowed to use this"                  >> elasticsearch.yml;
          echo -e "# limit."                                                                                  >> elasticsearch.yml;
          echo -e "#"                                                                                         >> elasticsearch.yml;
          echo -e "# Elasticsearch performs poorly when the system is swapping the memory."                   >> elasticsearch.yml;
          echo -e "#"                                                                                         >> elasticsearch.yml;
          echo -e "# ---------------------------------- Network -----------------------------------"          >> elasticsearch.yml;
          echo -e "#"                                                                                         >> elasticsearch.yml;
          echo -e "# By default Elasticsearch is only accessible on localhost. Set a different"               >> elasticsearch.yml;
          echo -e "# address here to expose this node on the network:"                                        >> elasticsearch.yml;
          echo -e "#"                                                                                         >> elasticsearch.yml;
          echo -e "#network.host: 192.168.0.1"                                                                >> elasticsearch.yml;
          echo -e "#"                                                                                         >> elasticsearch.yml;
          echo -e "# By default Elasticsearch listens for HTTP traffic on the first free port it"             >> elasticsearch.yml;
          echo -e "# finds starting at 9200. Set a specific HTTP port here:"                                  >> elasticsearch.yml;
          echo -e "#"                                                                                         >> elasticsearch.yml;
          echo -e "#http.port: 9200"                                                                          >> elasticsearch.yml;
          echo -e "#"                                                                                         >> elasticsearch.yml;
          echo -e "# For more information, consult the network module documentation."                         >> elasticsearch.yml;
          echo -e "#"                                                                                         >> elasticsearch.yml;
          echo -e "# --------------------------------- Discovery ----------------------------------"          >> elasticsearch.yml;
          echo -e "#"                                                                                         >> elasticsearch.yml;
          echo -e "# Pass an initial list of hosts to perform discovery when this node is started:"           >> elasticsearch.yml;
          echo -e "# The default list of hosts is [\"127.0.0.1\", \"[::1]\"]"                                 >> elasticsearch.yml;
          echo -e "#"                                                                                         >> elasticsearch.yml;
          echo -e "#discovery.seed_hosts: [\"host1\", \"host2\"]"                                             >> elasticsearch.yml;
          echo -e "#"                                                                                         >> elasticsearch.yml;
          echo -e "# Bootstrap the cluster using an initial set of master-eligible nodes:"                    >> elasticsearch.yml;
          echo -e "#"                                                                                         >> elasticsearch.yml;
          echo -e "#cluster.initial_master_nodes: [\"node-1\", \"node-2\"]"                                   >> elasticsearch.yml;
          echo -e "#"                                                                                         >> elasticsearch.yml;
          echo -e "# For more information, consult the discovery and cluster formation module documentation." >> elasticsearch.yml;
          echo -e "#"                                                                                         >> elasticsearch.yml;
          echo -e "# ---------------------------------- Various -----------------------------------"          >> elasticsearch.yml;
          echo -e "#"                                                                                         >> elasticsearch.yml;
          echo -e "# Allow wildcard deletion of indices:"                                                     >> elasticsearch.yml;
          echo -e "#"                                                                                         >> elasticsearch.yml;
          echo -e "#action.destructive_requires_name: false"                                                  >> elasticsearch.yml;
        fi;
        cat elasticsearch.yml;

        if [ -f "logstash.yml" ]; then
          echo -n ""                                                                                                                                  > logstash.yml;
          echo -e "# Settings file in YAML"                                                                                                          >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# Settings can be specified either in hierarchical form, e.g.:"                                                                   >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "#   pipeline:"                                                                                                                    >> logstash.yml;
          echo -e "#     batch:"                                                                                                                     >> logstash.yml;
          echo -e "#       size: 125"                                                                                                                >> logstash.yml;
          echo -e "#       delay: 5"                                                                                                                 >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# Or as flat keys:"                                                                                                               >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "#   pipeline.batch.size: 125"                                                                                                     >> logstash.yml;
          echo -e "#   pipeline.batch.delay: 5"                                                                                                      >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# ------------  Node identity ------------"                                                                                       >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# Use a descriptive name for the node:"                                                                                           >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# node.name: test"                                                                                                                >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# If omitted the node name will default to the machine's host name"                                                               >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# ------------ Data path ------------------"                                                                                      >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# Which directory should be used by logstash and its plugins"                                                                     >> logstash.yml;
          echo -e "# for any persistent needs. Defaults to LOGSTASH_HOME/data"                                                                       >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# path.data:"                                                                                                                     >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# ------------ Pipeline Settings --------------"                                                                                  >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# The ID of the pipeline."                                                                                                        >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# pipeline.id: main"                                                                                                              >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# Set the number of workers that will, in parallel, execute the filters+outputs"                                                  >> logstash.yml;
          echo -e "# stage of the pipeline."                                                                                                         >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# This defaults to the number of the host's CPU cores."                                                                           >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# pipeline.workers: 2"                                                                                                            >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# How many events to retrieve from inputs before sending to filters+workers"                                                      >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# pipeline.batch.size: 125"                                                                                                       >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# How long to wait in milliseconds while polling for the next event"                                                              >> logstash.yml;
          echo -e "# before dispatching an undersized batch to filters+outputs"                                                                      >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# pipeline.batch.delay: 50"                                                                                                       >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# Force Logstash to exit during shutdown even if there are still inflight"                                                        >> logstash.yml;
          echo -e "# events in memory. By default, logstash will refuse to quit until all"                                                           >> logstash.yml;
          echo -e "# received events have been pushed to the outputs."                                                                               >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# WARNING: enabling this can lead to data loss during shutdown"                                                                   >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# pipeline.unsafe_shutdown: false"                                                                                                >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# Set the pipeline event ordering. Options are \"auto\" (the default), \"true\" or \"false\"."                                    >> logstash.yml;
          echo -e "# \"auto\" will  automatically enable ordering if the 'pipeline.workers' setting"                                                 >> logstash.yml;
          echo -e "# is also set to '1'."                                                                                                            >> logstash.yml;
          echo -e "# \"true\" will enforce ordering on the pipeline and prevent logstash from starting"                                              >> logstash.yml;
          echo -e "# if there are multiple workers."                                                                                                 >> logstash.yml;
          echo -e "# \"false\" will disable any extra processing necessary for preserving ordering."                                                 >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# pipeline.ordered: auto"                                                                                                         >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# Sets the pipeline's default value for \`ecs_compatibility\`, a setting that is"                                                 >> logstash.yml;
          echo -e "# available to plugins that implement an ECS Compatibility mode for use with"                                                     >> logstash.yml;
          echo -e "# the Elastic Common Schema."                                                                                                     >> logstash.yml;
          echo -e "# Possible values are:"                                                                                                           >> logstash.yml;
          echo -e "# - disabled"                                                                                                                     >> logstash.yml;
          echo -e "# - v1"                                                                                                                           >> logstash.yml;
          echo -e "# - v8 (default)"                                                                                                                 >> logstash.yml;
          echo -e "# Pipelines defined before Logstash 8 operated without ECS in mind. To ensure a"                                                  >> logstash.yml;
          echo -e "# migrated pipeline continues to operate as it did before your upgrade, opt-OUT"                                                  >> logstash.yml;
          echo -e "# of ECS for the individual pipeline in its \`pipelines.yml\` definition. Setting"                                                >> logstash.yml;
          echo -e "# it here will set the default for _all_ pipelines, including new ones."                                                          >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# pipeline.ecs_compatibility: v8"                                                                                                 >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# ------------ Pipeline Configuration Settings --------------"                                                                    >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# Where to fetch the pipeline configuration for the main pipeline"                                                                >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# path.config:"                                                                                                                   >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# Pipeline configuration string for the main pipeline"                                                                            >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# config.string:"                                                                                                                 >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# At startup, test if the configuration is valid and exit (dry run)"                                                              >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# config.test_and_exit: false"                                                                                                    >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# Periodically check if the configuration has changed and reload the pipeline"                                                    >> logstash.yml;
          echo -e "# This can also be triggered manually through the SIGHUP signal"                                                                  >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# config.reload.automatic: false"                                                                                                 >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# How often to check if the pipeline configuration has changed (in seconds)"                                                      >> logstash.yml;
          echo -e "# Note that the unit value (s) is required. Values without a qualifier (e.g. 60) "                                                >> logstash.yml;
          echo -e "# are treated as nanoseconds."                                                                                                    >> logstash.yml;
          echo -e "# Setting the interval this way is not recommended and might change in later versions."                                           >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# config.reload.interval: 3s"                                                                                                     >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# Show fully compiled configuration as debug log message"                                                                         >> logstash.yml;
          echo -e "# NOTE: --log.level must be 'debug'"                                                                                              >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# config.debug: false"                                                                                                            >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# When enabled, process escaped characters such as \\\n and \\\" in strings in the"                                               >> logstash.yml;
          echo -e "# pipeline configuration files."                                                                                                  >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# config.support_escapes: false"                                                                                                  >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# ------------ API Settings -------------"                                                                                        >> logstash.yml;
          echo -e "# Define settings related to the HTTP API here."                                                                                  >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# The HTTP API is enabled by default. It can be disabled, but features that rely"                                                 >> logstash.yml;
          echo -e "# on it will not work as intended."                                                                                               >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# api.enabled: true"                                                                                                              >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# By default, the HTTP API is not secured and is therefore bound to only the"                                                     >> logstash.yml;
          echo -e "# host's loopback interface, ensuring that it is not accessible to the rest of"                                                   >> logstash.yml;
          echo -e "# the network."                                                                                                                   >> logstash.yml;
          echo -e "# When secured with SSL and Basic Auth, the API is bound to _all_ interfaces"                                                     >> logstash.yml;
          echo -e "# unless configured otherwise."                                                                                                   >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# api.http.host: 127.0.0.1"                                                                                                       >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# The HTTP API web server will listen on an available port from the given range."                                                 >> logstash.yml;
          echo -e "# Values can be specified as a single port (e.g., \`9600\`), or an inclusive range"                                               >> logstash.yml;
          echo -e "# of ports (e.g., \`9600-9700\`)."                                                                                                >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# api.http.port: 9600-9700"                                                                                                       >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# The HTTP API includes a customizable \"environment\" value in its response,"                                                    >> logstash.yml;
          echo -e "# which can be configured here."                                                                                                  >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# api.environment: \"production\""                                                                                                >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# The HTTP API can be secured with SSL (TLS). To do so, you will need to provide"                                                 >> logstash.yml;
          echo -e "# the path to a password-protected keystore in p12 or jks format, along with credentials."                                        >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# api.ssl.enabled: false"                                                                                                         >> logstash.yml;
          echo -e "# api.ssl.keystore.path: /path/to/keystore.jks"                                                                                   >> logstash.yml;
          echo -e "# api.ssl.keystore.password: \"y0uRp4\$$\$$w0rD\""                                                                                >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# The HTTP API can be configured to require authentication. Acceptable values are"                                                >> logstash.yml;
          echo -e "#  - \`none\`:  no auth is required (default)"                                                                                    >> logstash.yml;
          echo -e "#  - \`basic\`: clients must authenticate with HTTP Basic auth, as configured"                                                    >> logstash.yml;
          echo -e "#             with \`api.auth.basic.*\` options below"                                                                            >> logstash.yml;
          echo -e "# api.auth.type: none"                                                                                                            >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# When configured with \`api.auth.type\` \`basic\`, you must provide the credentials"                                             >> logstash.yml;
          echo -e "# that requests will be validated against. Usage of Environment or Keystore"                                                      >> logstash.yml;
          echo -e "# variable replacements is encouraged (such as the value \`\"\$${HTTP_PASS}\"\`, which"                                           >> logstash.yml;
          echo -e "# resolves to the value stored in the keystore's \`HTTP_PASS\` variable if present"                                               >> logstash.yml;
          echo -e "# or the same variable from the environment)"                                                                                     >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# api.auth.basic.username: \"logstash-user\""                                                                                     >> logstash.yml;
          echo -e "# api.auth.basic.password: \"s3cUreP4\$$\$$w0rD\""                                                                                >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# ------------ Module Settings ---------------"                                                                                   >> logstash.yml;
          echo -e "# Define modules here.  Modules definitions must be defined as an array."                                                         >> logstash.yml;
          echo -e "# The simple way to see this is to prepend each \`name\` with a \`-\`, and keep"                                                  >> logstash.yml;
          echo -e "# all associated variables under the \`name\` they are associated with, and"                                                      >> logstash.yml;
          echo -e "# above the next, like this:"                                                                                                     >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# modules:"                                                                                                                       >> logstash.yml;
          echo -e "#   - name: MODULE_NAME"                                                                                                          >> logstash.yml;
          echo -e "#     var.PLUGINTYPE1.PLUGINNAME1.KEY1: VALUE"                                                                                    >> logstash.yml;
          echo -e "#     var.PLUGINTYPE1.PLUGINNAME1.KEY2: VALUE"                                                                                    >> logstash.yml;
          echo -e "#     var.PLUGINTYPE2.PLUGINNAME1.KEY1: VALUE"                                                                                    >> logstash.yml;
          echo -e "#     var.PLUGINTYPE3.PLUGINNAME3.KEY1: VALUE"                                                                                    >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# Module variable names must be in the format of"                                                                                 >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# var.PLUGIN_TYPE.PLUGIN_NAME.KEY"                                                                                                >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# modules:"                                                                                                                       >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# ------------ Cloud Settings ---------------"                                                                                    >> logstash.yml;
          echo -e "# Define Elastic Cloud settings here."                                                                                            >> logstash.yml;
          echo -e "# Format of cloud.id is a base64 value e.g. dXMtZWFzdC0xLmF3cy5mb3VuZC5pbyRub3RhcmVhbCRpZGVudGlmaWVy"                             >> logstash.yml;
          echo -e "# and it may have an label prefix e.g. staging:dXMtZ..."                                                                          >> logstash.yml;
          echo -e "# This will overwrite 'var.elasticsearch.hosts' and 'var.kibana.host'"                                                            >> logstash.yml;
          echo -e "# cloud.id: <identifier>"                                                                                                         >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# Format of cloud.auth is: <user>:<pass>"                                                                                         >> logstash.yml;
          echo -e "# This is optional"                                                                                                               >> logstash.yml;
          echo -e "# If supplied this will overwrite 'var.elasticsearch.username' and 'var.elasticsearch.password'"                                  >> logstash.yml;
          echo -e "# If supplied this will overwrite 'var.kibana.username' and 'var.kibana.password'"                                                >> logstash.yml;
          echo -e "# cloud.auth: elastic:<password>"                                                                                                 >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# ------------ Queuing Settings --------------"                                                                                   >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# Internal queuing model, \"memory\" for legacy in-memory based queuing and"                                                      >> logstash.yml;
          echo -e "# \"persisted\" for disk-based acked queueing. Defaults is memory"                                                                >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# queue.type: memory"                                                                                                             >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# If using queue.type: persisted, the directory path where the data files will be stored."                                        >> logstash.yml;
          echo -e "# Default is path.data/queue"                                                                                                     >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# path.queue:"                                                                                                                    >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# If using queue.type: persisted, the page data files size. The queue data consists of"                                           >> logstash.yml;
          echo -e "# append-only data files separated into pages. Default is 64mb"                                                                   >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# queue.page_capacity: 64mb"                                                                                                      >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# If using queue.type: persisted, the maximum number of unread events in the queue."                                              >> logstash.yml;
          echo -e "# Default is 0 (unlimited)"                                                                                                       >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# queue.max_events: 0"                                                                                                            >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# If using queue.type: persisted, the total capacity of the queue in number of bytes."                                            >> logstash.yml;
          echo -e "# If you would like more unacked events to be buffered in Logstash, you can increase the"                                         >> logstash.yml;
          echo -e "# capacity using this setting. Please make sure your disk drive has capacity greater than"                                        >> logstash.yml;
          echo -e "# the size specified here. If both max_bytes and max_events are specified, Logstash will pick"                                    >> logstash.yml;
          echo -e "# whichever criteria is reached first"                                                                                            >> logstash.yml;
          echo -e "# Default is 1024mb or 1gb"                                                                                                       >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# queue.max_bytes: 1024mb"                                                                                                        >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# If using queue.type: persisted, the maximum number of acked events before forcing a checkpoint"                                 >> logstash.yml;
          echo -e "# Default is 1024, 0 for unlimited"                                                                                               >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# queue.checkpoint.acks: 1024"                                                                                                    >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# If using queue.type: persisted, the maximum number of written events before forcing a checkpoint"                               >> logstash.yml;
          echo -e "# Default is 1024, 0 for unlimited"                                                                                               >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# queue.checkpoint.writes: 1024"                                                                                                  >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# If using queue.type: persisted, the interval in milliseconds when a checkpoint is forced on the head page"                      >> logstash.yml;
          echo -e "# Default is 1000, 0 for no periodic checkpoint."                                                                                 >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# queue.checkpoint.interval: 1000"                                                                                                >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# ------------ Dead-Letter Queue Settings --------------"                                                                         >> logstash.yml;
          echo -e "# Flag to turn on dead-letter queue."                                                                                             >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# dead_letter_queue.enable: false"                                                                                                >> logstash.yml;
          echo -e ""                                                                                                                                 >> logstash.yml;
          echo -e "# If using dead_letter_queue.enable: true, the maximum size of each dead letter queue. Entries"                                   >> logstash.yml;
          echo -e "# will be dropped if they would increase the size of the dead letter queue beyond this setting."                                  >> logstash.yml;
          echo -e "# Default is 1024mb"                                                                                                              >> logstash.yml;
          echo -e "# dead_letter_queue.max_bytes: 1024mb"                                                                                            >> logstash.yml;
          echo -e ""                                                                                                                                 >> logstash.yml;
          echo -e "# If using dead_letter_queue.enable: true, the interval in milliseconds where if no further events eligible for the DLQ"          >> logstash.yml;
          echo -e "# have been created, a dead letter queue file will be written. A low value here will mean that more, smaller, queue files"        >> logstash.yml;
          echo -e "# may be written, while a larger value will introduce more latency between items being \"written\" to the dead letter queue, and" >> logstash.yml;
          echo -e "# being available to be read by the dead_letter_queue input when items are are written infrequently."                             >> logstash.yml;
          echo -e "# Default is 5000."                                                                                                               >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# dead_letter_queue.flush_interval: 5000"                                                                                         >> logstash.yml;
          echo -e ""                                                                                                                                 >> logstash.yml;
          echo -e "# If using dead_letter_queue.enable: true, the directory path where the data files will be stored."                               >> logstash.yml;
          echo -e "# Default is path.data/dead_letter_queue"                                                                                         >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# path.dead_letter_queue:"                                                                                                        >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# ------------ Debugging Settings --------------"                                                                                 >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# Options for log.level:"                                                                                                         >> logstash.yml;
          echo -e "#   * fatal"                                                                                                                      >> logstash.yml;
          echo -e "#   * error"                                                                                                                      >> logstash.yml;
          echo -e "#   * warn"                                                                                                                       >> logstash.yml;
          echo -e "#   * info (default)"                                                                                                             >> logstash.yml;
          echo -e "#   * debug"                                                                                                                      >> logstash.yml;
          echo -e "#   * trace"                                                                                                                      >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# log.level: info"                                                                                                                >> logstash.yml;
          echo -e "# path.logs:"                                                                                                                     >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# ------------ Other Settings --------------"                                                                                     >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# Where to find custom plugins"                                                                                                   >> logstash.yml;
          echo -e "# path.plugins: []"                                                                                                               >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# Flag to output log lines of each pipeline in its separate log file. Each log filename contains the pipeline.name"               >> logstash.yml;
          echo -e "# Default is false"                                                                                                               >> logstash.yml;
          echo -e "# pipeline.separate_logs: false"                                                                                                  >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# ------------ X-Pack Settings (not applicable for OSS build)--------------"                                                      >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# X-Pack Monitoring"                                                                                                              >> logstash.yml;
          echo -e "# https://www.elastic.co/guide/en/logstash/current/monitoring-logstash.html"                                                      >> logstash.yml;
          echo -e "#xpack.monitoring.enabled: false"                                                                                                 >> logstash.yml;
          echo -e "#xpack.monitoring.elasticsearch.username: logstash_system"                                                                        >> logstash.yml;
          echo -e "#xpack.monitoring.elasticsearch.password: password"                                                                               >> logstash.yml;
          echo -e "#xpack.monitoring.elasticsearch.proxy: [\"http://proxy:port\"]"                                                                   >> logstash.yml;
          echo -e "#xpack.monitoring.elasticsearch.hosts: [\"https://es1:9200\", \"https://es2:9200\"]"                                              >> logstash.yml;
          echo -e "# an alternative to hosts + username/password settings is to use cloud_id/cloud_auth"                                             >> logstash.yml;
          echo -e "#xpack.monitoring.elasticsearch.cloud_id: monitoring_cluster_id:xxxxxxxxxx"                                                       >> logstash.yml;
          echo -e "#xpack.monitoring.elasticsearch.cloud_auth: logstash_system:password"                                                             >> logstash.yml;
          echo -e "# another authentication alternative is to use an Elasticsearch API key"                                                          >> logstash.yml;
          echo -e "#xpack.monitoring.elasticsearch.api_key: \"id:api_key\""                                                                          >> logstash.yml;
          echo -e "#xpack.monitoring.elasticsearch.ssl.certificate_authority: [ \"/path/to/ca.crt\" ]"                                               >> logstash.yml;
          echo -e "#xpack.monitoring.elasticsearch.ssl.truststore.path: path/to/file"                                                                >> logstash.yml;
          echo -e "#xpack.monitoring.elasticsearch.ssl.truststore.password: password"                                                                >> logstash.yml;
          echo -e "#xpack.monitoring.elasticsearch.ssl.keystore.path: /path/to/file"                                                                 >> logstash.yml;
          echo -e "#xpack.monitoring.elasticsearch.ssl.keystore.password: password"                                                                  >> logstash.yml;
          echo -e "#xpack.monitoring.elasticsearch.ssl.verification_mode: certificate"                                                               >> logstash.yml;
          echo -e "#xpack.monitoring.elasticsearch.sniffing: false"                                                                                  >> logstash.yml;
          echo -e "#xpack.monitoring.collection.interval: 10s"                                                                                       >> logstash.yml;
          echo -e "#xpack.monitoring.collection.pipeline.details.enabled: true"                                                                      >> logstash.yml;
          echo -e "#"                                                                                                                                >> logstash.yml;
          echo -e "# X-Pack Management"                                                                                                              >> logstash.yml;
          echo -e "# https://www.elastic.co/guide/en/logstash/current/logstash-centralized-pipeline-management.html"                                 >> logstash.yml;
          echo -e "#xpack.management.enabled: false"                                                                                                 >> logstash.yml;
          echo -e "#xpack.management.pipeline.id: [\"main\", \"apache_logs\"]"                                                                       >> logstash.yml;
          echo -e "#xpack.management.elasticsearch.username: logstash_admin_user"                                                                    >> logstash.yml;
          echo -e "#xpack.management.elasticsearch.password: password"                                                                               >> logstash.yml;
          echo -e "#xpack.management.elasticsearch.proxy: [\"http://proxy:port\"]"                                                                   >> logstash.yml;
          echo -e "#xpack.management.elasticsearch.hosts: [\"https://es1:9200\", \"https://es2:9200\"]"                                              >> logstash.yml;
          echo -e "# an alternative to hosts + username/password settings is to use cloud_id/cloud_auth"                                             >> logstash.yml;
          echo -e "#xpack.management.elasticsearch.cloud_id: management_cluster_id:xxxxxxxxxx"                                                       >> logstash.yml;
          echo -e "#xpack.management.elasticsearch.cloud_auth: logstash_admin_user:password"                                                         >> logstash.yml;
          echo -e "# another authentication alternative is to use an Elasticsearch API key"                                                          >> logstash.yml;
          echo -e "#xpack.management.elasticsearch.api_key: \"id:api_key\""                                                                          >> logstash.yml;
          echo -e "#xpack.management.elasticsearch.ssl.certificate_authority: [ \"/path/to/ca.crt\" ]"                                               >> logstash.yml;
          echo -e "#xpack.management.elasticsearch.ssl.truststore.path: /path/to/file"                                                               >> logstash.yml;
          echo -e "#xpack.management.elasticsearch.ssl.truststore.password: password"                                                                >> logstash.yml;
          echo -e "#xpack.management.elasticsearch.ssl.keystore.path: /path/to/file"                                                                 >> logstash.yml;
          echo -e "#xpack.management.elasticsearch.ssl.keystore.password: password"                                                                  >> logstash.yml;
          echo -e "#xpack.management.elasticsearch.ssl.verification_mode: certificate"                                                               >> logstash.yml;
          echo -e "#xpack.management.elasticsearch.sniffing: false"                                                                                  >> logstash.yml;
          echo -e "#xpack.management.logstash.poll_interval: 5s"                                                                                     >> logstash.yml;
          echo -e ""                                                                                                                                 >> logstash.yml;
          echo -e "# X-Pack GeoIP plugin"                                                                                                            >> logstash.yml;
          echo -e "# https://www.elastic.co/guide/en/logstash/current/plugins-filters-geoip.html#plugins-filters-geoip-manage_update"                >> logstash.yml;
          echo -e "#xpack.geoip.download.endpoint: \"https://geoip.elastic.co/v1/database\""                                                         >> logstash.yml;
        fi;
        cat logstash.yml;

        if [ -f "pipelines.yml" ]; then
          echo -n ""                                                                                                                                    > pipelines.yml;
          echo -e "# List of pipelines to be loaded by Logstash"                                                                                       >> pipelines.yml;
          echo -e "#"                                                                                                                                  >> pipelines.yml;
          echo -e "# This document must be a list of dictionaries/hashes, where the keys/values are pipeline settings."                                >> pipelines.yml;
          echo -e "# Default values for omitted settings are read from the \`logstash.yml\` file."                                                     >> pipelines.yml;
          echo -e "# When declaring multiple pipelines, each MUST have its own \`pipeline.id\`."                                                       >> pipelines.yml;
          echo -e "#"                                                                                                                                  >> pipelines.yml;
          echo -e "# Example of two pipelines:"                                                                                                        >> pipelines.yml;
          echo -e "#"                                                                                                                                  >> pipelines.yml;
          echo -e "# - pipeline.id: test"                                                                                                              >> pipelines.yml;
          echo -e "#   pipeline.workers: 1"                                                                                                            >> pipelines.yml;
          echo -e "#   pipeline.batch.size: 1"                                                                                                         >> pipelines.yml;
          echo -e "#   config.string: \"input { generator {} } filter { sleep { time => 1 } } output { stdout { codec => dots } }\""                   >> pipelines.yml;
          echo -e "# - pipeline.id: another_test"                                                                                                      >> pipelines.yml;
          echo -e "#   queue.type: persisted"                                                                                                          >> pipelines.yml;
          echo -e "#   path.config: \"/tmp/logstash/*.config\""                                                                                        >> pipelines.yml;
          echo -e "#"                                                                                                                                  >> pipelines.yml;
          echo -e "# Available options:"                                                                                                               >> pipelines.yml;
          echo -e "#"                                                                                                                                  >> pipelines.yml;
          echo -e "#   # name of the pipeline"                                                                                                         >> pipelines.yml;
          echo -e "#   pipeline.id: mylogs"                                                                                                            >> pipelines.yml;
          echo -e "#"                                                                                                                                  >> pipelines.yml;
          echo -e "#   # The configuration string to be used by this pipeline"                                                                         >> pipelines.yml;
          echo -e "#   config.string: \"input { generator {} } filter { sleep { time => 1 } } output { stdout { codec => dots } }\""                   >> pipelines.yml;
          echo -e "#"                                                                                                                                  >> pipelines.yml;
          echo -e "#   # The path from where to read the configuration text"                                                                           >> pipelines.yml;
          echo -e "#   path.config: \"/etc/conf.d/logstash/myconfig.cfg\""                                                                             >> pipelines.yml;
          echo -e "#"                                                                                                                                  >> pipelines.yml;
          echo -e "#   # How many worker threads execute the Filters+Outputs stage of the pipeline"                                                    >> pipelines.yml;
          echo -e "#   pipeline.workers: 1 (actually defaults to number of CPUs)"                                                                      >> pipelines.yml;
          echo -e "#"                                                                                                                                  >> pipelines.yml;
          echo -e "#   # How many events to retrieve from inputs before sending to filters+workers"                                                    >> pipelines.yml;
          echo -e "#   pipeline.batch.size: 125"                                                                                                       >> pipelines.yml;
          echo -e "#"                                                                                                                                  >> pipelines.yml;
          echo -e "#   # How long to wait in milliseconds while polling for the next event"                                                            >> pipelines.yml;
          echo -e "#   # before dispatching an undersized batch to filters+outputs"                                                                    >> pipelines.yml;
          echo -e "#   pipeline.batch.delay: 50"                                                                                                       >> pipelines.yml;
          echo -e "#"                                                                                                                                  >> pipelines.yml;
          echo -e "#   # Internal queuing model, \"memory\" for legacy in-memory based queuing and"                                                    >> pipelines.yml;
          echo -e "#   # \"persisted\" for disk-based acked queueing. Defaults is memory"                                                              >> pipelines.yml;
          echo -e "#   queue.type: memory"                                                                                                             >> pipelines.yml;
          echo -e "#"                                                                                                                                  >> pipelines.yml;
          echo -e "#   # If using queue.type: persisted, the page data files size. The queue data consists of"                                         >> pipelines.yml;
          echo -e "#   # append-only data files separated into pages. Default is 64mb"                                                                 >> pipelines.yml;
          echo -e "#   queue.page_capacity: 64mb"                                                                                                      >> pipelines.yml;
          echo -e "#"                                                                                                                                  >> pipelines.yml;
          echo -e "#   # If using queue.type: persisted, the maximum number of unread events in the queue."                                            >> pipelines.yml;
          echo -e "#   # Default is 0 (unlimited)"                                                                                                     >> pipelines.yml;
          echo -e "#   queue.max_events: 0"                                                                                                            >> pipelines.yml;
          echo -e "#"                                                                                                                                  >> pipelines.yml;
          echo -e "#   # If using queue.type: persisted, the total capacity of the queue in number of bytes."                                          >> pipelines.yml;
          echo -e "#   # Default is 1024mb or 1gb"                                                                                                     >> pipelines.yml;
          echo -e "#   queue.max_bytes: 1024mb"                                                                                                        >> pipelines.yml;
          echo -e "#"                                                                                                                                  >> pipelines.yml;
          echo -e "#   # If using queue.type: persisted, the maximum number of acked events before forcing a checkpoint"                               >> pipelines.yml;
          echo -e "#   # Default is 1024, 0 for unlimited"                                                                                             >> pipelines.yml;
          echo -e "#   queue.checkpoint.acks: 1024"                                                                                                    >> pipelines.yml;
          echo -e "#"                                                                                                                                  >> pipelines.yml;
          echo -e "#   # If using queue.type: persisted, the maximum number of written events before forcing a checkpoint"                             >> pipelines.yml;
          echo -e "#   # Default is 1024, 0 for unlimited"                                                                                             >> pipelines.yml;
          echo -e "#   queue.checkpoint.writes: 1024"                                                                                                  >> pipelines.yml;
          echo -e "#"                                                                                                                                  >> pipelines.yml;
          echo -e "#   # If using queue.type: persisted, the interval in milliseconds when a checkpoint is forced on the head page"                    >> pipelines.yml;
          echo -e "#   # Default is 1000, 0 for no periodic checkpoint."                                                                               >> pipelines.yml;
          echo -e "#   queue.checkpoint.interval: 1000"                                                                                                >> pipelines.yml;
          echo -e "#"                                                                                                                                  >> pipelines.yml;
          echo -e "#   # Enable Dead Letter Queueing for this pipeline."                                                                               >> pipelines.yml;
          echo -e "#   dead_letter_queue.enable: false"                                                                                                >> pipelines.yml;
          echo -e "#"                                                                                                                                  >> pipelines.yml;
          echo -e "#   If using dead_letter_queue.enable: true, the maximum size of dead letter queue for this pipeline. Entries"                      >> pipelines.yml;
          echo -e "#   will be dropped if they would increase the size of the dead letter queue beyond this setting."                                  >> pipelines.yml;
          echo -e "#   Default is 1024mb"                                                                                                              >> pipelines.yml;
          echo -e "#   dead_letter_queue.max_bytes: 1024mb"                                                                                            >> pipelines.yml;
          echo -e "#"                                                                                                                                  >> pipelines.yml;
          echo -e "#   If using dead_letter_queue.enable: true, the interval in milliseconds where if no further events eligible for the DLQ"          >> pipelines.yml;
          echo -e "#   have been created, a dead letter queue file will be written. A low value here will mean that more, smaller, queue files"        >> pipelines.yml;
          echo -e "#   may be written, while a larger value will introduce more latency between items being \"written\" to the dead letter queue, and" >> pipelines.yml;
          echo -e "#   being available to be read by the dead_letter_queue input when items are are written infrequently."                             >> pipelines.yml;
          echo -e "#   Default is 5000."                                                                                                               >> pipelines.yml;
          echo -e "#"                                                                                                                                  >> pipelines.yml;
          echo -e "#   dead_letter_queue.flush_interval: 5000"                                                                                         >> pipelines.yml;
          echo -e ""                                                                                                                                   >> pipelines.yml;
          echo -e "#"                                                                                                                                  >> pipelines.yml;
          echo -e "#   If using dead_letter_queue.enable: true, the directory path where the data files will be stored."                               >> pipelines.yml;
          echo -e "#   Default is path.data/dead_letter_queue"                                                                                         >> pipelines.yml;
          echo -e "#"                                                                                                                                  >> pipelines.yml;
          echo -e "#   path.dead_letter_queue:"                                                                                                        >> pipelines.yml;
        fi;
        cat pipelines.yml;

        if [ -f "kibana.yml" ]; then
          echo -n ""                                                                                                                              > kibana.yml;
          echo -e "# For more configuration options see the configuration guide for Kibana in"                                                   >> kibana.yml;
          echo -e "# https://www.elastic.co/guide/index.html"                                                                                    >> kibana.yml;
          echo -e ""                                                                                                                             >> kibana.yml;
          echo -e "# =================== System: Kibana Server ==================="                                                              >> kibana.yml;
          echo -e "# Kibana is served by a back end server. This setting specifies the port to use."                                             >> kibana.yml;
          echo -e "server.port: 5601"                                                                                                            >> kibana.yml;
          echo -e ""                                                                                                                             >> kibana.yml;
          echo -e "# Specifies the address to which the Kibana server will bind. IP addresses and host names are both valid values."             >> kibana.yml;
          echo -e "# The default is 'localhost', which usually means remote machines will not be able to connect."                               >> kibana.yml;
          echo -e "# To allow connections from remote users, set this parameter to a non-loopback address."                                      >> kibana.yml;
          echo -e "server.host: \"localhost\""                                                                                                   >> kibana.yml;
          echo -e ""                                                                                                                             >> kibana.yml;
          echo -e "# Enables you to specify a path to mount Kibana at if you are running behind a proxy."                                        >> kibana.yml;
          echo -e "# Use the \`server.rewriteBasePath\` setting to tell Kibana if it should remove the basePath"                                 >> kibana.yml;
          echo -e "# from requests it receives, and to prevent a deprecation warning at startup."                                                >> kibana.yml;
          echo -e "# This setting cannot end in a slash."                                                                                        >> kibana.yml;
          echo -e "#server.basePath: \"\""                                                                                                       >> kibana.yml;
          echo -e ""                                                                                                                             >> kibana.yml;
          echo -e "# Specifies whether Kibana should rewrite requests that are prefixed with"                                                    >> kibana.yml;
          echo -e "# \`server.basePath\` or require that they are rewritten by your reverse proxy."                                              >> kibana.yml;
          echo -e "# Defaults to \`false\`."                                                                                                     >> kibana.yml;
          echo -e "#server.rewriteBasePath: false"                                                                                               >> kibana.yml;
          echo -e ""                                                                                                                             >> kibana.yml;
          echo -e "# Specifies the public URL at which Kibana is available for end users. If"                                                    >> kibana.yml;
          echo -e "# \`server.basePath\` is configured this URL should end with the same basePath."                                              >> kibana.yml;
          echo -e "#server.publicBaseUrl: \"\""                                                                                                  >> kibana.yml;
          echo -e ""                                                                                                                             >> kibana.yml;
          echo -e "# The maximum payload size in bytes for incoming server requests."                                                            >> kibana.yml;
          echo -e "#server.maxPayload: 1048576"                                                                                                  >> kibana.yml;
          echo -e ""                                                                                                                             >> kibana.yml;
          echo -e "# The Kibana server's name. This is used for display purposes."                                                               >> kibana.yml;
          echo -e "server.name: \"kibana\""                                                                                                      >> kibana.yml;
          echo -e ""                                                                                                                             >> kibana.yml;
          echo -e "# =================== System: Kibana Server (Optional) ==================="                                                   >> kibana.yml;
          echo -e "# Enables SSL and paths to the PEM-format SSL certificate and SSL key files, respectively."                                   >> kibana.yml;
          echo -e "# These settings enable SSL for outgoing requests from the Kibana server to the browser."                                     >> kibana.yml;
          echo -e "#server.ssl.enabled: false"                                                                                                   >> kibana.yml;
          echo -e "#server.ssl.certificate: /path/to/your/server.crt"                                                                            >> kibana.yml;
          echo -e "#server.ssl.key: /path/to/your/server.key"                                                                                    >> kibana.yml;
          echo -e ""                                                                                                                             >> kibana.yml;
          echo -e "# =================== System: Elasticsearch ==================="                                                              >> kibana.yml;
          echo -e "# The URLs of the Elasticsearch instances to use for all your queries."                                                       >> kibana.yml;
          echo -e "elasticsearch.hosts: [\"http://localhost:9200\"]"                                                                             >> kibana.yml;
          echo -e ""                                                                                                                             >> kibana.yml;
          echo -e "# If your Elasticsearch is protected with basic authentication, these settings provide"                                       >> kibana.yml;
          echo -e "# the username and password that the Kibana server uses to perform maintenance on the Kibana"                                 >> kibana.yml;
          echo -e "# index at startup. Your Kibana users still need to authenticate with Elasticsearch, which"                                   >> kibana.yml;
          echo -e "# is proxied through the Kibana server."                                                                                      >> kibana.yml;
          echo -e "elasticsearch.username: \"kibana_system\""                                                                                    >> kibana.yml;
          echo -e "elasticsearch.password: \"pass\""                                                                                             >> kibana.yml;
          echo -e ""                                                                                                                             >> kibana.yml;
          echo -e "# Kibana can also authenticate to Elasticsearch via \"service account tokens\"."                                              >> kibana.yml;
          echo -e "# Service account tokens are Bearer style tokens that replace the traditional username/password based configuration."         >> kibana.yml;
          echo -e "# Use this token instead of a username/password."                                                                             >> kibana.yml;
          echo -e "# elasticsearch.serviceAccountToken: \"my_token\""                                                                            >> kibana.yml;
          echo -e ""                                                                                                                             >> kibana.yml;
          echo -e "# Time in milliseconds to wait for Elasticsearch to respond to pings. Defaults to the value of"                               >> kibana.yml;
          echo -e "# the elasticsearch.requestTimeout setting."                                                                                  >> kibana.yml;
          echo -e "#elasticsearch.pingTimeout: 1500"                                                                                             >> kibana.yml;
          echo -e ""                                                                                                                             >> kibana.yml;
          echo -e "# Time in milliseconds to wait for responses from the back end or Elasticsearch. This value"                                  >> kibana.yml;
          echo -e "# must be a positive integer."                                                                                                >> kibana.yml;
          echo -e "#elasticsearch.requestTimeout: 30000"                                                                                         >> kibana.yml;
          echo -e ""                                                                                                                             >> kibana.yml;
          echo -e "# Specifies whether Kibana should use compression for communications with elasticsearch"                                      >> kibana.yml;
          echo -e "# Defaults to \`false\`."                                                                                                     >> kibana.yml;
          echo -e "#elasticsearch.compression: false"                                                                                            >> kibana.yml;
          echo -e ""                                                                                                                             >> kibana.yml;
          echo -e "# List of Kibana client-side headers to send to Elasticsearch. To send *no* client-side"                                      >> kibana.yml;
          echo -e "# headers, set this value to [] (an empty list)."                                                                             >> kibana.yml;
          echo -e "#elasticsearch.requestHeadersWhitelist: [ authorization ]"                                                                    >> kibana.yml;
          echo -e ""                                                                                                                             >> kibana.yml;
          echo -e "# Header names and values that are sent to Elasticsearch. Any custom headers cannot be overwritten"                           >> kibana.yml;
          echo -e "# by client-side headers, regardless of the elasticsearch.requestHeadersWhitelist configuration."                             >> kibana.yml;
          echo -e "#elasticsearch.customHeaders: {}"                                                                                             >> kibana.yml;
          echo -e ""                                                                                                                             >> kibana.yml;
          echo -e "# Time in milliseconds for Elasticsearch to wait for responses from shards. Set to 0 to disable."                             >> kibana.yml;
          echo -e "#elasticsearch.shardTimeout: 30000"                                                                                           >> kibana.yml;
          echo -e ""                                                                                                                             >> kibana.yml;
          echo -e "# =================== System: Elasticsearch (Optional) ==================="                                                   >> kibana.yml;
          echo -e "# These files are used to verify the identity of Kibana to Elasticsearch and are required when"                               >> kibana.yml;
          echo -e "# xpack.security.http.ssl.client_authentication in Elasticsearch is set to required."                                         >> kibana.yml;
          echo -e "#elasticsearch.ssl.certificate: /path/to/your/client.crt"                                                                     >> kibana.yml;
          echo -e "#elasticsearch.ssl.key: /path/to/your/client.key"                                                                             >> kibana.yml;
          echo -e ""                                                                                                                             >> kibana.yml;
          echo -e "# Enables you to specify a path to the PEM file for the certificate"                                                          >> kibana.yml;
          echo -e "# authority for your Elasticsearch instance."                                                                                 >> kibana.yml;
          echo -e "#elasticsearch.ssl.certificateAuthorities: [ \"/path/to/your/CA.pem\" ]"                                                      >> kibana.yml;
          echo -e ""                                                                                                                             >> kibana.yml;
          echo -e "# To disregard the validity of SSL certificates, change this setting's value to 'none'."                                      >> kibana.yml;
          echo -e "#elasticsearch.ssl.verificationMode: full"                                                                                    >> kibana.yml;
          echo -e ""                                                                                                                             >> kibana.yml;
          echo -e "# =================== System: Logging ==================="                                                                    >> kibana.yml;
          echo -e "# Set the value of this setting to off to suppress all logging output, or to debug to log everything. Defaults to 'info'"     >> kibana.yml;
          echo -e "#logging.root.level: debug"                                                                                                   >> kibana.yml;
          echo -e ""                                                                                                                             >> kibana.yml;
          echo -e "# Enables you to specify a file where Kibana stores log output."                                                              >> kibana.yml;
          echo -e "#logging.appenders.default:"                                                                                                  >> kibana.yml;
          echo -e "#  type: file"                                                                                                                >> kibana.yml;
          echo -e "#  fileName: /var/logs/kibana.log"                                                                                            >> kibana.yml;
          echo -e "#  layout:"                                                                                                                   >> kibana.yml;
          echo -e "#    type: json"                                                                                                              >> kibana.yml;
          echo -e ""                                                                                                                             >> kibana.yml;
          echo -e "# Logs queries sent to Elasticsearch."                                                                                        >> kibana.yml;
          echo -e "#logging.loggers:"                                                                                                            >> kibana.yml;
          echo -e "#  - name: elasticsearch.query"                                                                                               >> kibana.yml;
          echo -e "#    level: debug"                                                                                                            >> kibana.yml;
          echo -e ""                                                                                                                             >> kibana.yml;
          echo -e "# Logs http responses."                                                                                                       >> kibana.yml;
          echo -e "#logging.loggers:"                                                                                                            >> kibana.yml;
          echo -e "#  - name: http.server.response"                                                                                              >> kibana.yml;
          echo -e "#    level: debug"                                                                                                            >> kibana.yml;
          echo -e ""                                                                                                                             >> kibana.yml;
          echo -e "# Logs system usage information."                                                                                             >> kibana.yml;
          echo -e "#logging.loggers:"                                                                                                            >> kibana.yml;
          echo -e "#  - name: metrics.ops"                                                                                                       >> kibana.yml;
          echo -e "#    level: debug"                                                                                                            >> kibana.yml;
          echo -e ""                                                                                                                             >> kibana.yml;
          echo -e "# =================== System: Other ==================="                                                                      >> kibana.yml;
          echo -e "# The path where Kibana stores persistent data not saved in Elasticsearch. Defaults to data"                                  >> kibana.yml;
          echo -e "#path.data: data"                                                                                                             >> kibana.yml;
          echo -e ""                                                                                                                             >> kibana.yml;
          echo -e "# Specifies the path where Kibana creates the process ID file."                                                               >> kibana.yml;
          echo -e "#pid.file: /run/kibana/kibana.pid"                                                                                            >> kibana.yml;
          echo -e ""                                                                                                                             >> kibana.yml;
          echo -e "# Set the interval in milliseconds to sample system and process performance"                                                  >> kibana.yml;
          echo -e "# metrics. Minimum is 100ms. Defaults to 5000ms."                                                                             >> kibana.yml;
          echo -e "#ops.interval: 5000"                                                                                                          >> kibana.yml;
          echo -e ""                                                                                                                             >> kibana.yml;
          echo -e "# Specifies locale to be used for all localizable strings, dates and number formats."                                         >> kibana.yml;
          echo -e "# Supported languages are the following: English - en , by default , Chinese - zh-CN ."                                       >> kibana.yml;
          echo -e "#i18n.locale: \"en\""                                                                                                         >> kibana.yml;
          echo -e ""                                                                                                                             >> kibana.yml;
          echo -e "# =================== Frequently used (Optional)==================="                                                          >> kibana.yml;
          echo -e ""                                                                                                                             >> kibana.yml;
          echo -e "# =================== Saved Objects: Migrations ==================="                                                          >> kibana.yml;
          echo -e "# Saved object migrations run at startup. If you run into migration-related issues, you might need to adjust these settings." >> kibana.yml;
          echo -e ""                                                                                                                             >> kibana.yml;
          echo -e "# The number of documents migrated at a time."                                                                                >> kibana.yml;
          echo -e "# If Kibana can't start up or upgrade due to an Elasticsearch \`circuit_breaking_exception\`,"                                >> kibana.yml;
          echo -e "# use a smaller batchSize value to reduce the memory pressure. Defaults to 1000 objects per batch."                           >> kibana.yml;
          echo -e "#migrations.batchSize: 1000"                                                                                                  >> kibana.yml;
          echo -e ""                                                                                                                             >> kibana.yml;
          echo -e "# The maximum payload size for indexing batches of upgraded saved objects."                                                   >> kibana.yml;
          echo -e "# To avoid migrations failing due to a 413 Request Entity Too Large response from Elasticsearch."                             >> kibana.yml;
          echo -e "# This value should be lower than or equal to your Elasticsearch cluster’s \`http.max_content_length\`"                       >> kibana.yml;
          echo -e "# configuration option. Default: 100mb"                                                                                       >> kibana.yml;
          echo -e "#migrations.maxBatchSizeBytes: 100mb"                                                                                         >> kibana.yml;
          echo -e ""                                                                                                                             >> kibana.yml;
          echo -e "# The number of times to retry temporary migration failures. Increase the setting"                                            >> kibana.yml;
          echo -e "# if migrations fail frequently with a message such as \`Unable to complete the [...] step after"                             >> kibana.yml;
          echo -e "# 15 attempts, terminating\`. Defaults to 15"                                                                                 >> kibana.yml;
          echo -e "#migrations.retryAttempts: 15"                                                                                                >> kibana.yml;
          echo -e ""                                                                                                                             >> kibana.yml;
          echo -e "# =================== Search Autocomplete ==================="                                                                >> kibana.yml;
          echo -e "# Time in milliseconds to wait for autocomplete suggestions from Elasticsearch."                                              >> kibana.yml;
          echo -e "# This value must be a whole number greater than zero. Defaults to 1000ms"                                                    >> kibana.yml;
          echo -e "#data.autocomplete.valueSuggestions.timeout: 1000"                                                                            >> kibana.yml;
          echo -e ""                                                                                                                             >> kibana.yml;
          echo -e "# Maximum number of documents loaded by each shard to generate autocomplete suggestions."                                     >> kibana.yml;
          echo -e "# This value must be a whole number greater than zero. Defaults to 100_000"                                                   >> kibana.yml;
          echo -e "#data.autocomplete.valueSuggestions.terminateAfter: 100000"                                                                   >> kibana.yml;
        fi;
        cat kibana.yml;

    hostname: "Elastic"
    image: "elasticsearch:8.1.0"
    user: "0"
    volumes:
      - "Elastic_Config:/usr/share/elasticsearch/config"

  Elasticsearch:
    container_name: "Elasticsearch"
    depends_on:
      - "Elastic"
    environment:
      - "cluster.name=elasticsearch"
      - "discovery.type=single-node"
      - "ELASTIC_PASSWORD=tg4mYT%3M&r~QwHEOp9%"
      - "ES_JAVA_OPTS=-Xms512m -Xmx512m"
    hostname: "Elasticsearch"
    image: "elasticsearch:8.1.0"
    networks:
      - "Elastic"
    ports:
      - "9200:9200"
      - "9300:9300"
    restart: "always"
    volumes:
      - "Elastic_Config:/usr/share/elasticsearch/config"
      - "Elasticsearch_Data:/usr/share/elasticsearch/data"
      - "Elasticsearch_Plugins:/usr/share/elasticsearch/plugins"

  Logstash:
    container_name: "Logstash"
    depends_on:
      - "Elasticsearch"
    hostname: "Logstash"
    image: "logstash:8.1.0"
    networks:
      - "Elastic"
    ports:
      - "9600:9600"
      - "5044:5044"
    restart: "always"
    volumes:
      - "Elastic_Config:/usr/share/logstash/config"
      - "Logstash_Data:/usr/share/logstash/data"
      - "Logstash_Pipeline:/usr/share/logstash/pipeline"

  Kibana:
    container_name: "Kibana"
    depends_on:
      - "Elasticsearch"
    hostname: "Kibana"
    image: "kibana:8.1.0"
    networks:
      - "Elastic"
    ports:
      - "5601:5601"
    restart: "always"
    volumes:
      - "Elastic_Config:/usr/share/kibana/config"
      - "Kibana_Data:/usr/share/kibana/data"
    
networks:
  Elastic:
    driver: bridge

volumes:
  SqlServer_Data:
    driver: local
  MongoDB_Config:
    driver: local
  MongoDB_Data:
    driver: local
  RabbitMQ_Data:
    driver: local
  Redis_Data:
    driver: local
  Elastic_Config:
    driver: local
  Elasticsearch_Data:
    driver: local
  Elasticsearch_Plugins:
    driver: local
  Logstash_Data:
    driver: local
  Logstash_Pipeline:
    driver: local
  Kibana_Data:
    driver: local
